# Brax Training Viewer for Real-Time Policy Visualization

This project is developed during the [Google Summer of Code 2025](https://summerofcode.withgoogle.com/programs/2025/projects/Xm0toJHl).

Reinforcement Learning (RL) training in Brax operates at high performance, utilizing JAX for efficient parallelized training. However, due to the nature of JAXâ€™s computation model, training occurs in a highly abstracted and batched manner, making it challenging to inspect agent behavior in real-time. Currently, users must either wait until training finishes to evaluate policies or extract rollout data manually, which is inefficient and restricts debugging capabilities. A Brax Training Viewer would empower users to visualize the evolution of the policy while training is ongoing, bridging the gap between RL research and practical interpretability.

The Brax Training Viewer offers an interactive, real-time visualization tool for monitoring reinforcement learning (RL) policies during training, utilizing the official PPO training function from Brax. This package allows users to synchronize the training with a MuJoCo-based viewer, showcasing the effect of the actions taken by the RL policy across numerous parallel environments. Users can benefit from real-time action updates, which enable them to track the evolution of the policy over time. A toggle option to enable or disable synchronization will be provided to enhance performance, allowing users to pause visualization and speed up the training process temporarily.

As this tool extends the official Brax PPO training function, it ensures seamless compatibility with current reinforcement learning pipelines. This allows for easy implementation without changing existing RL workflows, making it an excellent choice for researchers and practitioners needing to visualize, debug, and analyze RL policies in Brax with minimal configuration.

## Outcomes

* **Synchronized MuJoCo Visualization with Brax Training**: Extract actions generated by the policy network at each training step and apply them to a parallel running MuJoCo simulation.
* **Support Parallel Environments**: The viewer will visualize multiple parallel agents, reflecting the exact training conditions in Brax.
* **Allow Enable/Disable Rendering**: Since the copy process from GPU to CPU slows down the training process, users can dynamically enable or disable the data transfer to have high-speed training without visual feedback or keep visualization synchronized at the cost of slower training.

## Installation and Setup

**Important**: This viewer requires the Brax submodule which contains additional features needed for real-time visualization. The official Brax package is not compatible.

### About the Brax Submodule
This project includes a custom Brax fork as a git submodule that contains additional features needed for the viewer.

### Conda
-   (Optionally) install Python virtual environment [conda](https://www.anaconda.com/docs/getting-started/miniconda/main)
-   (Optionally) create a virtual environment `conda create -n test python=3.10`
-   `conda activate test`
-   `cd` to the root folder of this repo
-   run `git submodule update --init --recursive` (This downloads the required Brax submodule)
-   run `pip install -e brax/` (Install the local Brax submodule)
-   run `pip install .` (Install braxviewer)
-   run `pip install -r requirements.txt`
-   (Optionally) install Jax with hardware acceleration: `pip install -U "jax[cuda12]"` or `pip install -U "jax[cuda11]"` or `pip install -U "jax[tpu]"`
-   You can try the examples in the `examples/` folder, for example: `python examples/cartpole/cartpole.py`
-   Open a web browser and go to `http://127.0.0.1:8000` for the viewer.

### UV
[UV](https://github.com/astral-sh/uv) is an extremely fast Python package installer and resolver, written in Rust.
-   `cd` to the root folder of this repo
-   run `git submodule update --init --recursive` (This downloads the required Brax submodule)
-   Install uv `pip install uv`
-   Create a virtual environment `uv venv`
-   Activate the virtual environment `source .venv/bin/activate`
-   Install dependencies `uv pip install -r requirements.txt`
-   Install the project with `uv pip install -e brax/` and `uv pip install .`
-   You can try the examples provided in the `examples/` folder, for instance: `python examples/cartpole/cartpole.py`
-   Open a web browser and navigate to `http://127.0.0.1:8000` to see the viewer.

### Troubleshooting

**If you get "ModuleNotFoundError: No module named 'brax'"**:
- Run `git submodule update --init --recursive`
- Run `pip install -e brax/`

**If you have conflicts with official brax**:
- Run `pip uninstall brax`
- Run `pip install -e brax/`


## How to Use

Integrating the viewer into your existing Brax training script is straightforward:
1. Import the necessary components.
read2. Create a viewer and wrap your environment with `ViewerWrapper`.
3. Pass the wrapped environment to the `ppo.train` function.



### 1. Import Modules
```python
from braxviewer.WebViewerParallel import WebViewerParallel
from brax.training.agents.ppo import train as ppo
from brax.io import model
from braxviewer.WebViewer import WebViewer
from brax.envs.wrappers.training import EpisodeWrapper, AutoResetWrapper
from braxviewer.wrapper import ViewerWrapper
```

### 2. Create Viewer and Wrap Environment
```python
# Create your environment
env = YourBraxEnvironment(xml_model=xml_model)

# Create viewer
viewer = WebViewerParallel(num_envs=8, xml=xml_model)
viewer.run()

# Wrap with ViewerWrapper
env_for_training = ViewerWrapper(env=env, viewer=viewer)
```

### 3. Start Training
```python
make_policy_fn, params, _ = ppo.train(
    environment=env_for_training,
    # ... other training parameters
)
```
